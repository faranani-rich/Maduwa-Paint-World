<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Edit Project – Maduwa Paint World</title>
    <link rel="stylesheet" href="styles/main.css" />
    <link rel="stylesheet" href="styles/print.css" media="print" />
    <style>
      /* ...[Your existing <style> block unchanged]... */
      main {
        max-width: 1100px;
        margin: 2.5em auto;
        background: #fff;
        padding: 2em 2em 1.5em 2em;
        border-radius: 18px;
        box-shadow: 0 6px 32px #005a8d14;
      }
      h2 {
        margin-top: 2em;
        color: #005a8d;
      }
      .grid-2col {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2em;
      }
      @media (max-width: 900px) {
        .grid-2col {
          grid-template-columns: 1fr;
        }
      }
      section {
        margin-bottom: 1.6em;
        padding-bottom: 1.3em;
        border-bottom: 1px solid #eef1f3;
      }
      label {
        display: block;
        margin: 0.9em 0 1em 0;
      }
      input,
      select,
      textarea {
        display: block;
        width: 100%;
        max-width: 350px;
        font-size: 1em;
        padding: 0.6em 0.8em;
        margin-top: 0.4em;
        border-radius: 7px;
        border: 1px solid #bbb;
        background: #fafbfc;
      }
      .flex {
        display: flex;
        gap: 2em;
        flex-wrap: wrap;
      }
      .actions {
        display: flex;
        gap: 1.1em;
        margin: 2em 0 0 0;
        flex-wrap: wrap;
      }
      .actions button {
        font-size: 1.1em;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1em;
      }
      th,
      td {
        border: 1px solid #c3e2f5;
        padding: 7px 9px;
        text-align: left;
      }
      th.internal-only,
      td.internal-only {
        background: #fff7de;
        color: #a0760a;
        font-style: italic;
      }
      .scrollable-cell {
        max-height: 48px;
        overflow-y: auto;
        min-width: 90px;
      }
      .wider-km {
        min-width: 80px;
        max-width: 180px;
      }
      .progress-bar-bg {
        background: #eee;
        border-radius: 10px;
        height: 22px;
        width: 100%;
        margin: 0.7em 0;
      }
      .progress-bar {
        background: #005a8d;
        height: 100%;
        border-radius: 10px;
        color: #fff;
        padding-left: 8px;
        font-weight: bold;
        font-size: 1em;
        transition: width 0.4s;
      }
      #totals p {
        margin: 0.4em 0;
      }
      .table-scroll {
        overflow-x: auto;
        width: 100%;
        -webkit-overflow-scrolling: touch;
        margin-bottom: 1em;
      }
      .table-scroll table {
        min-width: 1100px;
        width: max-content;
      }
      @media (max-width: 700px) {
        main {
          padding: 1.2em 0.4em;
        }
        input,
        select,
        textarea {
          max-width: 100%;
        }
        .table-scroll table {
          min-width: 900px;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Edit Project</h1>
      <button id="back-btn">← Back to Dashboard</button>
    </header>

    <main>
      <form id="project-form">
        <!-- Project Info + Progress (2-column grid) -->
        <section class="grid-2col">
          <div>
            <h2>Project Info</h2>
            <label>
              Name
              <input type="text" name="name" required />
            </label>
            <label>
              Location
              <input type="text" name="location" />
            </label>
            <label>
              Status
              <select name="status">
                <option value="quotation">Quotation</option>
                <option value="approved">Approved</option>
                <option value="in-progress">In Progress</option>
                <option value="completed">Completed</option>
              </select>
            </label>
            <label>
              Project Manager Name
              <input type="text" name="pm-name" />
            </label>
            <label>
              Project Manager Email
              <input type="email" name="pm-email" />
            </label>
            <label>
              Customer Name
              <input type="text" name="cust-name" />
            </label>
            <label>
              Customer Email
              <input type="email" name="cust-email" />
            </label>
          </div>
          <div>
            <h2>Progress & Estimation</h2>
            <label>
              Estimated Duration
              <input
                type="text"
                name="estimated-duration"
                placeholder="E.g. 40 hours or 1 week, 2 days"
              />
            </label>
            <label>
              Hours Worked
              <input type="number" name="hours-worked" min="0" />
            </label>
            <label>
              Percent Complete (%)
              <input
                type="number"
                name="progress"
                min="0"
                max="100"
                step="1"
                readonly
              />
            </label>
            <div class="progress-bar-bg">
              <div class="progress-bar" id="progress-bar" style="width: 0%">
                0%
              </div>
            </div>
            <label>
              Progress Notes
              <textarea
                name="progress-comment"
                rows="2"
                placeholder="E.g., Finished undercoat, waiting for client…"
              ></textarea>
            </label>
          </div>
        </section>

        <!-- Employees -->
        <section>
          <h2>Employees Assigned</h2>
          <table id="employees-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Role</th>
                <th class="internal-only">Hours</th>
                <th class="internal-only">Overtime Hours</th>
                <th class="internal-only">Normal Rate/hr</th>
                <th class="internal-only">Overtime Rate</th>
                <th class="internal-only">Bonus</th>
                <th class="internal-only">Total Pay</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <button type="button" id="add-employee-btn">+ Add Employee</button>
        </section>

        <!-- Paints -->
        <section>
          <h2>Paints Used</h2>
          <table id="paints-table">
            <thead>
              <tr>
                <th>Type</th>
                <th>Color</th>
                <th>Buckets</th>
                <th>Supplier</th>
                <th>Date Bought</th>
                <th class="internal-only">Cost/Bucket</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <button type="button" id="add-paint-btn">+ Add Paint</button>
        </section>

        <!-- Materials -->
        <section>
          <h2>Materials</h2>
          <table id="materials-table">
            <thead>
              <tr>
                <th>Description</th>
                <th>Quantity</th>
                <th class="internal-only">Unit Cost</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <button type="button" id="add-material-btn">+ Add Material</button>
        </section>

        <!-- Vehicles/Trips (INTERNAL ONLY) -->
        <section class="internal-only">
          <h2>Vehicles & Trips</h2>
          <div class="table-scroll">
            <table id="vehicles-table">
              <thead>
                <tr>
                  <th>Driver</th>
                  <th>Car</th>
                  <th>Purpose</th>
                  <th class="wider-km">KM</th>
                  <th class="internal-only">Petrol</th>
                  <th class="internal-only">Tolls</th>
                  <th>Destination</th>
                  <th>Date</th>
                  <th>Notes</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <!-- Rendered by JS, use <input type="date"> for Date fields in rows! -->
              </tbody>
            </table>
          </div>
          <button type="button" id="add-vehicle-btn">+ Add Vehicle/Trip</button>
        </section>

        <!-- Other Expenses (INTERNAL ONLY) -->
        <section class="internal-only">
          <h2>Other Expenses</h2>
          <table id="expenses-table">
            <thead>
              <tr>
                <th>Type</th>
                <th>Amount</th>
                <th>Notes</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <button type="button" id="add-expense-btn">+ Add Expense</button>
        </section>

        <!-- Profit & Totals -->
        <section>
          <h2>Profit &amp; Totals</h2>
          <label class="internal-only">
            Markup %
            <input type="number" name="markupPct" min="0" />
          </label>
          <div id="totals">
            <!--
              <p class="internal-only">Cost: R...</p>
              <p class="internal-only">Profit: R...</p>
              <p>Price: R...</p>
            -->
          </div>
        </section>

        <!-- Notes / Instructions -->
        <section>
          <h2>Notes / Instructions</h2>
          <textarea
            name="notes"
            rows="3"
            placeholder="Site-specific notes, client requests, etc…"
          ></textarea>
        </section>

        <!-- Internal Notes (private to company/owner) (INTERNAL ONLY) -->
        <section class="internal-only">
          <h2>Internal Notes</h2>
          <textarea
            name="internal-notes"
            rows="2"
            placeholder="Private notes (not shown to customer/printout)"
          ></textarea>
        </section>

        <!-- Actions: Save + Print Copies -->
        <div class="actions">
          <button type="submit">Save</button>
          <button type="button" id="print-customer">Print Customer Copy</button>
          <button type="button" id="print-internal">Print Internal Copy</button>
        </div>
      </form>
    </main>

    <!-- App logic -->
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script type="module" src="js/project.js"></script>
    <script type="module" src="js/project-enhancements.js"></script>
  </body>
</html>
